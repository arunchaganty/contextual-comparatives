{% extends "base.html" %}

{% block body %}
<div class="page-header">
<h1>Describe a numeric expression in English</h1>
</div>

<div class="col-md-12">

  <div class="panel panel-default panel-info">
    <div class="panel-heading">
      <h3 class="panel-title">Instructions</h3>
    </div>
    <div class="panel-body">
      <p>
      In each part of this task, you will be given an sentence with a highlighted number, followed by a few descriptions of what else that number could be:

      <span class="example">Example</span>
      <blockquote>
        A previous <b>500,000 barrel</b> a day increase in production, which went into effect Nov. 1, was widely viewed as too little too late to stop crude's run-up to near $100 a barrel.

        <small>
          <div class="form-group">
            <b>500,000 barrel</b> is about:
            <div class="checkbox">
              <label>
                <input type="checkbox"> 1/7 the coffee consumed by Microsoft employees in their average lifespan.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox"> the coffee consumption of a population equal to Stanford's in the average lifetime of a person.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox" checked> one third the oil produced by the world during lunch.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox" checked> one fourth the flow of tap water during the average lifetime of a person.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox"> 5 times the amount of coffee consumed by the population of Asia during the duration of lunch.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox"> double the coffee consumed by oil industry workers over the time it takes to graduate from college.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox"> one seventh of the coffee consumption of the number of employees at Google in the average life time of a tree.
              </label>
            </div><div class="checkbox">
              <label>
                <input type="checkbox"> None of the above make any sense.
              </label>
            </div>
          </div>
        </small>
      </blockquote>

      <p>
      We would like you to pick <b>up to three</b> of these descriptions that <b>are useful in understanding the scale of the highlighted number</b>. This is an subjective task (that's why we're asking you for help!): we have marked our personal preferences above, but you could choose differently. 
      Please do not consider the factual accuracy of the comparisons while making your choices, and ignore minor spelling errors.
      </p>

      <p>
      Here are some further examples with our personal choices (remember you can choose differently!): 
      </p>

      <span class="example">Example</span>
      <blockquote> 
        The deal, negotiated by Turkey and Brazil, calls for Iran to ship 1,200 kilograms, or <b>2,640 pounds</b> of low enriched uranium to Turkey, where it would be stored. 

        <small>
          <div class="form-group">
            <b>2,640 pounds</b> is about:
            <div  class="checkbox">
              <label>
                <input name="response-31503" type="checkbox" checked> half of the weight of a car.
              </label>
            </div><div  class="checkbox">
              <label>
                <input name="response-17651" type="checkbox"> 1/9 the amount of trash generated in the US in a minute by employees in the construction industry
              </label>
            </div><div  class="checkbox">
              <label>
                <input name="response-26394" type="checkbox"> the amunt of trash generated in the US by the population of Stanford in the time taken for a basketball game. 
              </label>
            </div><div  class="checkbox">
              <label>
                <input name="response--1" type="checkbox"> None of the above make any sense.
              </label>
            </div>
          </div>
        </small>
      </blockquote> 

      <span class="example">Example</span>
      <blockquote>
        It takes up <b>185,000 square feet</b> -- more than three football fields -- in a far corner of the center's 500-acre sculpture garden.

        <small>
          <div class="form-group">
            <b>185,000 square feet</b> is about:
            <div class="checkbox">
              <label>
                <input name="response-15507" type="checkbox" checked> two times the size of an American football field.
              </label>
            </div><div class="checkbox">
              <label>
                <input name="response-43292" type="checkbox" checked> area of a city block.
              </label>
            </div><div class="checkbox">
              <label>
                <input name="response--1" type="checkbox"> None of the above make any sense.
              </label>
            </div>
          </div>
        </small>
      </blockquote>

      <span class="example">Example</span>
      <blockquote>
        Then his fortune unraveled: In 2005 he was accused of orchestrating the scheme to buy votes with monthly bribes of as much as <b>US$13,000</b> (euro9,500) per legislator.

        <small>
          <div class="form-group">
            <b>US$13,000</b> is about:
            <div class="checkbox">
              <label>
                <input id="response-18263-18182" name="response-18263-18182" type="checkbox"> the salary of all the people killed by gun violence in 2016 in an hour.
              </label>
            </div><div class="checkbox">
              <label>
                <input id="response-18263-31025" name="response-18263-31025" type="checkbox"> three times the salary of all of the employees in the retail industry in the blink of an eye.
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input id="response-18263-19079" name="response-18263-19079" type="checkbox"> the cost of employees numbering the population of California in the time taken to blink.
              </label>
            </div>
            <div class="checkbox">
              <label>
                <input id="response-18263-19184" name="response-18263-19184" type="checkbox"> 1/7th the cost of employing the population of Stanford for the time taken for lunch.
              </label>
            </div><div class="checkbox">
              <label>
                <input id="response-18263--1" name="response-18263--1" type="checkbox" checked> None of the above make any sense.
              </label>
            </div></div>

        </small>
      </blockquote>


      <p>
      <b>Estimated time for task:</b> 2 minutes.
      </p>
      <p>
      <b>Note about evaluation:</b> we have included a few (very) obviously wrong choices in the set below, and will manually evaluate your responses if you violate them.
      </p>
    </div>
  </div>


<div class="panel panel-default panel-primary">
  <div class="panel-heading">
    <h3 class="panel-title">Task</h3>
  </div>

  <input id="tasks" type="hidden" name="tasks" value="{{tasks}}">

  <div id="tasklist">

  <div id="choice-template" class="checkbox hidden">
    <label>
      <input id="response-@@mention_id@@-@@choice_id@@" name="response-@@mention_id@@-@@choice_id@@" type="checkbox"> @@choice_gloss@@
    </label>
  </div>
  <div id="task-template" class="panel panel-default hidden">
    <div class="panel-heading">
      <h4 class="panel-title">Part @@j@@</h4>
    </div>

    <div class="panel-body">
      <!-- Consider the following combination of statements and describe their combination. -->
      <blockquote>
        @@sentence_gloss@@
      </blockquote>

      <div class="form-group">
        <b>@@mention_gloss@@</b> is about:
      </div>
    </div>
  </div>

  </div>

  <div class="alert alert-danger hidden" id="errorBox">
    Some responses were not filled.
  </div>
  <div class="alert alert-success hidden" id="successBox">
    Thank you for your input!
  </div>


<input name="submit" class="btn btn-primary" type="submit" id="submitButton" value="Submit" />

    <script type="text/javascript">
function parseTasks() {
  var tasks = $('#tasks').attr('value').split('\t');
  for(var i = 0; i < tasks.length; i++) {
    tasks[i] = jQuery.parseJSON(tasks[i]);
    for(var j = 0; j < tasks[i].choices.length; j++) {
      tasks[i].choices[j] = jQuery.parseJSON(tasks[i].choices[j]);
    }
  }
  return tasks;
}
var tasks = parseTasks();

  // Aggregate output.
function validateInputs() {
  // Check that the input has been inserted.
  var prompts = getPrompts();
  var success = true;
  var valueStr = "";
  for (var i = 0; i < prompts.length; i++) {
    var response = $("#response-"+i).val();
    if(response.length > 0) {
      if (valueStr.length > 0) {
        valueStr += "\t";
      }
      valueStr += response;
    } else {
      success = false;
    }
  }
  $('#responses').attr("value", valueStr);

  if (success) {
    $("#errorBox").addClass("hidden");
    $("#successBox").removeClass("hidden");
  } else {
    $("#errorBox").removeClass("hidden");
    $("#successBox").addClass("hidden");
  }

  return success;
}

function emptyChoice(mention_id) {
  return {"mention_id":mention_id, "response_id" : -1, "gloss": "None of the above make any sense."};
}

function addChoice(choice) {
  var div = $("#choice-template").clone();
  div.html(div.html()
      .replace(/@@mention_id@@/g, choice.mention_id)
      .replace(/@@choice_id@@/g, choice.response_id)
      .replace(/@@choice_gloss@@/g, choice.gloss));
  div.removeAttr("id");
  div.removeClass("hidden");
  return div;
}

// Create a copy of the template class and replace key variables.
function addTask(i, task) {
  var div = $("#task-template").clone();

  // Set id
  div.attr("id", "task-"+i);
  // Replace @@i@@ and @@prompt@@.
  div.html(div.html()
      .replace(/@@i@@/g, i)
      .replace(/@@j@@/g, i+1)
      .replace(/@@sentence_gloss@@/g, task.sentence_gloss)
      .replace(/@@mention_gloss@@/, task.mention_gloss));
  var choice_list = $(div.find('div.form-group')[0]);
  for (var i = 0; i < task.choices.length; i++) {
    choice_list.append(addChoice(task.choices[i]));
  }
  choice_list.append(addChoice(emptyChoice(task.mention_id)));
  // Make visible.
  div.removeClass("hidden");
  // Add to the tasklist
  $("#tasklist").append(div);
}

$(document).ready(function() {
  // Render the tasks.
  for(var i = 0; i < tasks.length; i++) {
    addTask(i, tasks[i]);
  }

  // Capture the submit button.
  $('#submitButton').click(validateInputs);
});
    </script>

</div>

</div>

{% endblock %}
